{"version":3,"file":"../ShipWeapon.js","sourceRoot":"../../src","sources":["ShipWeapon.coffee"],"names":[],"mappings":"AAAA,IAAA,UAAA,EAAA,UAAA,EAAA,UAAA,EAAA,KAAA,EAAA;;AAAA,KAAA,GAAQ,OAAA,CAAQ,kBAAR,CAA2B,CAAC;;AACpC,MAAA,GAAS,OAAA,CAAQ,mBAAR;;AACT,UAAA,GAAa,OAAA,CAAQ,cAAR;;AACb,UAAA,GAAa,OAAA,CAAQ,cAAR;;AAEb,MAAM,CAAC,OAAP,GAAuB;EAAN,MAAA,WAAA,QAAyB,MAAzB;IAEf,WAAa,CAAC,OAAD,CAAA;WACX,CAAA;MACA,IAAC,CAAA,aAAD,CAAe,OAAf;IAFW;;IAmCb,IAAM,CAAA,CAAA;AACJ,UAAA;MAAA,IAAG,IAAC,CAAA,OAAJ;QACE,UAAA,GAAa,IAAI,UAAJ,CAAe;UAC1B,MAAA,EAAQ,IADkB;UAE1B,MAAA,EAAQ,IAAC,CAAA,MAFiB;UAG1B,KAAA,EAAO,IAAC,CAAA,KAHkB;UAI1B,UAAA,EAAY,IAAC,CAAA,UAJa;UAK1B,eAAA,EAAiB,IAAC,CAAA,eALQ;UAM1B,KAAA,EAAO,IAAC,CAAA,eANkB;UAO1B,MAAA,EAAQ,IAAC,CAAA;QAPiB,CAAf;QASb,UAAU,CAAC,MAAX,CAAA;QACA,IAAC,CAAA,OAAD,GAAW;QACX,IAAC,CAAA,QAAD,CAAA;eACA,WAbF;;IADI;;IAeN,QAAU,CAAA,CAAA;MACR,IAAC,CAAA,QAAD,GAAY;aACZ,IAAC,CAAA,aAAD,GAAiB,IAAC,CAAA,MAAM,CAAC,UAAR,CAAmB,CAAA,CAAA,GAAA;QAClC,IAAC,CAAA,QAAD,GAAY;eACZ,IAAC,CAAA,SAAD,CAAA;MAFkC,CAAnB,EAGf,IAAC,CAAA,YAHc;IAFT;;IAMV,SAAW,CAAA,CAAA;MACT,IAAC,CAAA,OAAD,GAAW;MACX,IAAG,IAAC,CAAA,QAAJ;eACE,IAAC,CAAA,IAAD,CAAA,EADF;;IAFS;;EA1DI;;EACf,UAAC,CAAA,MAAD,CAAQ,UAAR;;EAIA,UAAC,CAAA,UAAD,CACE;IAAA,YAAA,EACE;MAAA,OAAA,EAAS;IAAT,CADF;IAEA,KAAA,EACE;MAAA,OAAA,EAAS;IAAT,CAHF;IAIA,UAAA,EACE;MAAA,OAAA,EAAS;IAAT,CALF;IAMA,eAAA,EACE;MAAA,OAAA,EAAS;IAAT,CAPF;IAQA,eAAA,EACE;MAAA,OAAA,EAAS;IAAT,CATF;IAUA,MAAA,EACE;MAAA,OAAA,EAAS,IAAT;MACA,MAAA,EAAQ,QAAA,CAAA,CAAA;QACN,IAAG,IAAC,CAAA,QAAJ;iBACE,IAAC,CAAA,IAAD,CAAA,EADF;;MADM;IADR,CAXF;IAeA,OAAA,EACE;MAAA,OAAA,EAAS;IAAT,CAhBF;IAiBA,QAAA,EACE;MAAA,OAAA,EAAS;IAAT,CAlBF;IAmBA,OAAA,EACE;MAAA,OAAA,EAAS;IAAT,CApBF;IAqBA,QAAA,EACE;MAAA,OAAA,EAAS;IAAT,CAtBF;IAuBA,cAAA,EACE;MAAA,OAAA,EAAS;IAAT,CAxBF;IAyBA,OAAA,EACE;MAAA,GAAA,EAAK,QAAA,CAAA,CAAA;eACH,IAAC,CAAA,MAAD,IAAY,IAAC,CAAA,OAAb,IAAyB,IAAC,CAAA,OAA1B,IAAsC,IAAC,CAAA,MAAD,GAAU,IAAC,CAAA,SAAX,IAAwB,IAAC,CAAA;MAD5D;IAAL,CA1BF;IA4BA,MAAA,EACE;MAAA,MAAA,EAAQ,QAAA,CAAA,CAAA;eACN,IAAI,MAAJ,CAAA;MADM;IAAR;EA7BF,CADF","sourcesContent":["Tiled = require('parallelio-tiles').Tiled\nTiming = require('parallelio-timing')\nDamageable = require('./Damageable')\nProjectile = require('./Projectile')\n\nmodule.exports = class ShipWeapon extends Tiled\n  @extend Damageable\n  constructor: (options) ->\n    super()\n    @setProperties(options)\n  @properties\n    rechargeTime:\n      default: 1000\n    power:\n      default: 10\n    blastRange:\n      default: 1\n    propagationType:\n      default: null\n    projectileSpeed:\n      default: 10\n    target:\n      default: null\n      change: ->\n        if @autoFire\n          @fire()\n    charged:\n      default: true\n    charging:\n      default: true\n    enabled:\n      default: true\n    autoFire:\n      default: true\n    criticalHealth:\n      default: 0.3\n    canFire:\n      get: ->\n        @target and @enabled and @charged and @health / @maxHealth >= @criticalHealth\n    timing:\n      calcul: ->\n        new Timing()\n  fire: ->\n    if @canFire\n      projectile = new Projectile({\n        origin: this\n        target: @target\n        power: @power\n        blastRange: @blastRange\n        propagationType: @propagationType\n        speed: @projectileSpeed\n        timing: @timing\n      })\n      projectile.launch()\n      @charged = false\n      @recharge()\n      projectile\n  recharge: ->\n    @charging = true\n    @chargeTimeout = @timing.setTimeout =>\n      @charging = false\n      @recharged()\n    , @rechargeTime\n  recharged: ->\n    @charged = true\n    if @autoFire\n      @fire()\n\n\n"]}